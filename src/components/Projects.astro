---
// TODO: Fix Image optimization to work in Vercel prod env
/*
import { Image } from "astro:assets";
//https://docs.astro.build/en/guides/images
//https://docs.astro.build/en/guides/images/#display-optimized-images-with-the-image--component
//https://docs.astro.build/en/guides/images/#images-in-content-collections
type ImportedImageModule = { default: string };
const images: Record<string, ImportedImageModule> = import.meta.glob(
  "/src/images/*.webp",
  { eager: true }
);

function getImportedImage(imagePath: string): string {
  const fileName = imagePath.split("/").pop() as string;
  return images[`/src/images/${fileName}`].default;
}
*/

import { myResume } from "../data/resume";
---

<section
  id="projects"
  class="py-20 bg-gray-50 dark:bg-gray-800 transition-colors duration-300"
>
  <div class="container mx-auto px-4">
    <h2 class="text-3xl font-bold mb-12 text-center fade-in">Side Projects</h2>

    <div class="flex flex-wrap justify-center gap-8">
      {
        myResume.sideProjects.map((project) => {
          //const importedImage: string = getImportedImage(project.image);

          return (
            <div class="w-full md:w-1/2 lg:w-1/3">
              <div class="bg-white dark:bg-gray-900 rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 fade-in">
                <div class="relative">
                  <img
                    src={project.image}
                    alt={`${project.title} logo`}
                    class="w-60 h-48 object-cover mx-auto"
                    width={240}
                    height={192}
                  />
                  {project.isProd && (
                    <div class="absolute top-0 right-0 bg-indigo-600 text-white text-xs font-bold px-2 py-1 m-2 rounded">
                      Production
                    </div>
                  )}
                </div>

                <div class="p-6">
                  <h3 class="text-xl font-bold mb-2">{project.title}</h3>

                  <p class="text-gray-700 dark:text-gray-300 mb-4">
                    {project.description}
                  </p>

                  <div class="flex flex-wrap gap-2 mb-4">
                    {project.stack.map((tech) => (
                      <span class="px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-300 rounded text-xs">
                        {tech}
                      </span>
                    ))}
                  </div>

                  <div class="flex justify-between items-center">
                    {project?.source && (
                      <a
                        href={project.source}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium transition-colors"
                      >
                        View Source
                      </a>
                    )}

                    {project?.url && (
                      <a
                        href={project.url}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium transition-colors"
                      >
                        Live Demo
                      </a>
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        })
      }
    </div>
  </div>
</section>
